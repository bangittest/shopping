<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<title>Sumire Store</title>
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
	<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
			crossorigin="anonymous">

	<link rel="stylesheet"
		  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
		  integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
		  crossorigin="anonymous" referrerpolicy="no-referrer"/>

	<link rel="stylesheet" href="/css/style.css">
</head>
<body>
<style>
	.menu-icon {
		margin-right: 6px; /* ho·∫∑c ƒëi·ªÅu ch·ªânh px tu·ª≥ √Ω */
	}
	footer {
		background-color: #212529; /* n·ªÅn t·ªëi */
		padding: 40px 0;
		font-size: 14px;
		color: #fff;
	}

	.footer-title {
		color: #fff;
	}

	.footer-block .content span,
	.footer-block .content a {
		color: #ddd;
	}

	.footer-block .content a:hover {
		color: #0d6efd; /* ƒë·ªïi m√†u khi hover */
		text-decoration: none; /* b·ªè g·∫°ch ch√¢n */
	}

	.footer-block ul.list-menu li a {
		color: #ccc; /* M√†u ch·ªØ cho li√™n k·∫øt */
		font-family: 'Arial', sans-serif; /* ƒê·ªïi font ch·ªØ */
		text-decoration: none; /* B·ªè g·∫°ch ch√¢n */
	}

	.footer-block ul.list-menu li a:hover {
		color: #0d6efd;
		text-decoration: none; /* B·ªè g·∫°ch ch√¢n khi hover */
	}

	.fot_copyright {
		color: #aaa;
	}

	.wsp a {
		color: #ddd;
		text-decoration: none;
	}

	.wsp a:hover {
		text-decoration: underline;
	}

	/* ƒê·∫£m b·∫£o navbar c√≥ m√†u n·ªÅn tr·∫Øng v√† ch·ªØ s√°ng */
	.navbar-light .navbar-nav .nav-link {
		color: #555 !important;  /* Ch·ªØ m√†u x√°m nh·∫π, s√°ng h∆°n */
	}

	.navbar-light .navbar-nav .nav-link.active {
		color: #555 !important;  /* Ch·ªØ m√†u x√°m khi c√≥ active */
	}

	.navbar-light .navbar-nav .dropdown-item {
		color: #555 !important;  /* M√†u ch·ªØ cho c√°c m·ª•c trong dropdown */
	}

	.navbar-light .navbar-nav .dropdown-item:hover {
		background-color: #f8f9fa !important;  /* M√†u n·ªÅn khi hover */
	}

	/* ƒê·∫£m b·∫£o bi·ªÉu t∆∞·ª£ng m√†u x√°m s√°ng */
	.navbar-light .navbar-nav .nav-link i {
		color: #555 !important; /* Bi·ªÉu t∆∞·ª£ng m√†u x√°m s√°ng */
	}

	/* Thay ƒë·ªïi m√†u ch·ªØ trong menu khi hover */
	.navbar-light .navbar-nav .nav-link:hover,
	.navbar-light .navbar-nav .dropdown-item:hover {
		color: #333 !important; /* M√†u ch·ªØ khi hover */
	}

	/* Thay ƒë·ªïi m√†u s·∫Øc cho bi·ªÉu t∆∞·ª£ng cart n·∫øu mu·ªën */
	.navbar-light .navbar-nav .nav-link i.fa-cart-shopping {
		font-size: 18px; /* Ch·ªânh k√≠ch th∆∞·ªõc c·ªßa bi·ªÉu t∆∞·ª£ng */
		color: #555;  /* M√†u x√°m s√°ng */
	}

	/* ƒê·∫£m b·∫£o gi·ªè h√†ng v√† s·ªë l∆∞·ª£ng hi·ªÉn th·ªã ƒë·∫πp */
	.mini-cart .header-icon {
		display: flex;
		width:20px ;
		height:20px ;
		align-items: center;
		position: relative;
	}

	/* CƒÉn ch·ªânh gi·ªè h√†ng v√† s·ªë l∆∞·ª£ng */
	.mini-cart {
		position: relative;
		top: -4px; /* ƒê·ªÉ c√≥ th·ªÉ cƒÉn ch·ªânh s·ªë l∆∞·ª£ng m·ªôt c√°ch ch√≠nh x√°c */
		display: inline-flex;  /* Gi·ªØ cho bi·ªÉu t∆∞·ª£ng v√† s·ªë l∆∞·ª£ng th·∫≥ng h√†ng */
		align-items: center;  /* CƒÉn gi·ªØa theo chi·ªÅu d·ªçc */
	}

	/* CƒÉn ch·ªânh bi·ªÉu t∆∞·ª£ng gi·ªè h√†ng */
	.header-icon i {
		font-size: 16px;   /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc bi·ªÉu t∆∞·ª£ng gi·ªè h√†ng */
		color: #555;       /* M√†u s·∫Øc bi·ªÉu t∆∞·ª£ng gi·ªè h√†ng */
	}

	/* S·ªë l∆∞·ª£ng trong gi·ªè h√†ng (count) */
	.count_item {
		font-size: 8px;     /* ƒêi·ªÅu ch·ªânh k√≠ch th∆∞·ªõc c·ªßa s·ªë l∆∞·ª£ng */
		color: #fff;         /* M√†u ch·ªØ c·ªßa s·ªë l∆∞·ª£ng */
		background-color: #f44336; /* M√†u n·ªÅn c·ªßa s·ªë l∆∞·ª£ng */
		position: absolute;
		top: -10px;           /* ƒê·∫©y l√™n tr√™n m·ªôt ch√∫t */
		right: -5px;         /* ƒê·∫©y sang b√™n ph·∫£i m·ªôt ch√∫t */
		width: 14px;         /* K√≠ch th∆∞·ªõc c·ªßa v√≤ng tr√≤n */
		height: 14px;        /* K√≠ch th∆∞·ªõc c·ªßa v√≤ng tr√≤n */
		border-radius: 50%;  /* T·∫°o h√¨nh tr√≤n */
		display: flex;
		justify-content: center;  /* CƒÉn gi·ªØa ch·ªØ trong v√≤ng tr√≤n */
		align-items: center;      /* CƒÉn gi·ªØa ch·ªØ trong v√≤ng tr√≤n */
		font-weight: bold;        /* ƒê·ªãnh d·∫°ng ch·ªØ cho s·ªë l∆∞·ª£ng */
	}

	/* T√πy ch·ªânh th√™m n·∫øu mu·ªën th√™m hi·ªáu ·ª©ng cho khi gi·ªè h√†ng c√≥ s·∫£n ph·∫©m */
	.count_item_pr {
		font-size: 14px;
	}


</style>
<nav class="navbar navbar-expand-lg bg-white fixed-top navbar-light">
	<div class="container-fluid">
		<a class="nav-link active" href="/">
			<img alt="" src="img/logo.png" width="134px" height="45px">
		</a>
		<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="navbarSupportedContent">
			<ul class="navbar-nav me-auto mb-2 mb-lg-0">
				<th:block th:if="${user==null}">
					<li class="nav-item"><a class="nav-link active" aria-current="page" href="/"><i class="fa-solid fa-house"></i> Trang ch·ªß</a></li>
				</th:block>

				<th:block th:unless="${user==null}">
					<li class="nav-item" th:if="${user.role=='ROLE_ADMIN'}"><a class="nav-link active" aria-current="page" href="/admin/"><i class="fa-solid fa-house"></i> Home</a></li>

					<li class="nav-item" th:if="${user.role=='ROLE_USER'}"><a class="nav-link active" aria-current="page" href="/"><i class="fa-solid fa-house"></i> Trang ch·ªß</a></li>
				</th:block>

				<li class="nav-item d-flex align-items-center ms-2">
					<img src="img/menu_icon_1.png" width="24" height="24" class="menu-icon" alt="T·∫•t c·∫£ s·∫£n ph·∫©m">
					<a class="nav-link active" aria-current="page" href="/products">T·∫•t c·∫£ s·∫£n ph·∫©m</a>
				</li>

				<li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">Danh m·ª•c</a>
					<ul class="dropdown-menu">
						<li th:each="c:${categorys}"><a class="dropdown-item" th:href="@{'/products?category='+${c.name}}">[[${c.name}]]</a></li>
					</ul>
				</li>
			</ul>

			<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
				<th:block th:if="${user==null}">
					<li class="nav-item"><a class="nav-link active" aria-current="page" href="/signin"><i class="fa-solid fa-right-to-bracket"></i> LOGIN</a></li>
					<li class="nav-item"><a class="nav-link active" aria-current="page" href="/register">REGISTER</a></li>
				</th:block>

				<th:block th:if="${user!=null}">
					<th:block th:if="${user.role=='ROLE_USER'}">
						<!-- Chuy·ªÉn t·ª´ "Cart [1]" sang bi·ªÉu t∆∞·ª£ng cart -->
						<li class="nav-item">
							<a class="nav-link active" href="/user/cart">
								<div class="mini-cart text-xs-center">
									<a class="header-icon cart-count ega-color--inherit" href="/user/cart" title="Gi·ªè h√†ng">
										<i class="fas fa-shopping-cart"></i>  <!-- Bi·ªÉu t∆∞·ª£ng gi·ªè h√†ng FontAwesome -->
										<span class="count_item count_item_pr">[[${countCart}]]</span> <!-- S·ªë l∆∞·ª£ng s·∫£n ph·∫©m trong gi·ªè -->
									</a>
								</div>
							</a>
						</li>


					</th:block>
					<li class="nav-item dropdown"><a class="nav-link dropdown-toggle active" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa-solid fa-user"></i> [[${user.name}]]</a>
						<ul class="dropdown-menu">
							<li th:if="${user.role=='ROLE_USER'}"><a class="dropdown-item" href="/user/profile">Profile</a></li>

							<li th:if="${user.role=='ROLE_ADMIN'}"><a class="dropdown-item" href="/admin/profile">Profile</a></li>

							<li th:if="${user.role=='ROLE_USER'}"><a class="dropdown-item" href="/user/user-orders">My Orders</a></li>
							<li><a class="dropdown-item" href="/logout">Logout</a></li>
							<li>
								<hr class="dropdown-divider">
							</li>
						</ul>
					</li>
				</th:block>
			</ul>
		</div>
	</div>
</nav>
<section>
	<div class="container mt-5 pt-5 mb-5">
		<div class="card shadow-lg p-4 rounded-4 border-0">
			<div class="row g-4 align-items-center">



				<!-- H√¨nh ·∫£nh s·∫£n ph·∫©m -->
				<div class="col-md-6 text-center">
					<img th:src="@{'/img/product_img/' + ${product.image}}"
						 class="img-fluid rounded shadow-sm border"
						 style="max-height: 350px; object-fit: contain;" alt="product">
				</div>

				<!-- Th√¥ng tin s·∫£n ph·∫©m -->
				<div class="col-md-6">
					<h2 class="mb-3 fw-semibold">[[${product.title}]]</h2>
					<p><strong>M√¥ t·∫£:</strong><br>[[${product.description}]]</p>

					<p class="mb-2">
						<strong>Tr·∫°ng th√°i:</strong>
						<th:block th:if="${product.stock > 0}">
							<span class="badge bg-success">C√≤n h√†ng</span>
						</th:block>
						<th:block th:unless="${product.stock > 0}">
							<span class="badge bg-secondary">H·∫øt h√†ng</span>
						</th:block>
					</p>

					<p class="mb-2"><strong>Danh m·ª•c:</strong> [[${product.category}]]</p>
					<p class="mb-4"><strong>Ch√≠nh s√°ch:</strong> ƒê·ªïi/tr·∫£ trong 7 ng√†y</p>

					<h4 class="text-danger mb-3">
						<small  th:text="${#numbers.formatDecimal(product.discountPrice, 0, 'COMMA', 0, 'POINT') + ' ƒë'}"></small>
<!--						[[${product.discountPrice}]]‚Ç´-->
						<small class="text-decoration-line-through text-muted ms-2" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 0, 'POINT') + ' ƒë'}"></small>
						<small class="text-success ms-2" >[[${product.discount}]]% gi·∫£m</small>
					</h4>

					<!-- Icon th√¥ng tin -->
					<div class="row text-center mb-4">
						<div class="col">
							<i class="fas fa-money-bill-wave fa-lg text-success mb-2"></i>
							<p class="small">COD</p>
						</div>
						<div class="col">
							<i class="fas fa-undo-alt fa-lg text-danger mb-2"></i>
							<p class="small">ƒê·ªïi tr·∫£</p>
						</div>
						<div class="col">
							<i class="fas fa-truck-moving fa-lg text-primary mb-2"></i>
							<p class="small">Mi·ªÖn ph√≠ giao</p>
						</div>
					</div>

					<!-- N√∫t Add to Cart -->
					<th:block th:if="${product.stock > 0}">
						<th:block th:if="${user != null}">
							<button class="btn btn-danger w-100 py-2"
									id="addToCartBtn"
									th:data-pid="${product.id}"
									th:data-uid="${user.id}">
								üõí Th√™m v√†o gi·ªè
							</button>
						</th:block>
						<th:block th:unless="${user != null}">
							<a href="/signin" class="btn btn-danger w-100 py-2">üõí Th√™m v√†o gi·ªè</a>
						</th:block>
					</th:block>

					<th:block th:unless="${product.stock > 0}">
						<button class="btn btn-secondary w-100 py-2" disabled>H·∫øt h√†ng</button>
					</th:block>
				</div>
			</div>
		</div>
	</div>
</section>




<script
		src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script
		src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.5/dist/jquery.validate.js"></script>
<script type="text/javascript" src="js/script.js"></script>
<script type="text/javascript" src="../js/script.js"></script>
<!-- End  -->
<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
		crossorigin="anonymous"></script>
</body>
</html>

<script>
	$(document).ready(function () {
		$('#addToCartBtn').click(function () {
			const pid = $(this).data('pid');
			const uid = $(this).data('uid');

			$.ajax({
				url: '/user/addCart',
				method: 'POST',
				data: {
					pid: pid,
					uid: uid
				},
				success: function () {
					alert('‚úÖ S·∫£n ph·∫©m ƒë√£ ƒë∆∞·ª£c th√™m v√†o gi·ªè h√†ng!');
					// C√≥ th·ªÉ reload gi·ªè ho·∫∑c c·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng n·∫øu mu·ªën
					// location.reload(); ho·∫∑c c·∫≠p nh·∫≠t DOM
					location.reload();
				},
				error: function () {
					alert('‚ùå L·ªói khi th√™m v√†o gi·ªè h√†ng. Vui l√≤ng th·ª≠ l·∫°i!');
				}
			});
		});
	});
</script>
